<!DOCTYPE html> 
<html> 
    <head> 
        <title>Message</title> 
        <!--
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0a2/jquery.mobile-1.0a2.min.css" />	
        <script src="http://code.jquery.com/jquery-1.4.4.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.0a2/jquery.mobile-1.0a2.min.js"></script>-->
        <meta name="viewport" content="width=device-width, user-scalable=no"> 
        
        <link rel="stylesheet" href="css-js/jquery.mobile-1.0a2.min.css" />	
        <script src="css-js/jquery-1.4.4.min.js"></script>
        <script src="css-js/jquery.mobile-1.0a2.min.js"></script>
        <script src="css-js/jquery.ba-dotimeout.js"></script> 
        <script src="css-js/jquery.dst.js"></script> 
        <script type="text/javascript">
            $(document).bind("mobileinit", function() {
                $.support.cors = true;
                $.mobile.allowCrossDomainPages = true;
            });
        </script>
        <script type="text/javascript" src="cordova.js"></script>

    </head> 
    <body style="height: 100%"> 
        <!-- Login -->
        <div data-role="page" id="login">
            <div data-role="header">
                <h3>
                    LOGIN
                </h3>
            </div>
            <div data-role="content">
                <div> <br/> <br/> <br/> <br/> <br/> <br/> <br/> </div>
                <form id="sendMessage" onsubmit="callSubmit();">
                    <div data-role="fieldcontain" >
                        <input name="phoneNumber" id="phoneNumber" placeholder="Phone Number" value="" type="tel">
                        <input name="password" id="password" placeholder="Password" value="" type="password">
                        <input type=submit value=Login>
                        <input type=button value=Signup>
                    </div>
                </form>
            </div>
        </div>

        <!-- Home -->
        <div data-role="page" id="home">
            <div data-role="header">
                <h3>
                    HOME
                </h3>
                 <a href="#" data-role="button" id="goLogout">Logout</a>
            </div>
        </div>
        </body>
        <script type="text/javascript">
// Listener that will invoke the onDeviceReady() function as soon as phonegap has loaded properly
        document.addEventListener("deviceready", onDeviceReady, false);
        function onDeviceReady() {
            navigator.splashscreen.hide();
            document.addEventListener("backbutton", onBackClickEvent, false); // Adding the back button listener    
                
                alert("Ready");

            }

            function callSubmit() {
               $.ajax({
                  type: "POST",
                  url: "http://codenameapp.herokuapp.com/user/login",
                  data: {
                    phoneNumber: $('#phoneNumber').val(),
                    password: $('#password').val()
                  },
                  success: function(data) {
                  if(data.logged_in) {
                      $.mobile.changePage($('#home'), {
                        transition: 'slide'
                        });
                   }
                    else
                        alert('nevamind!');
                   }
                  }); 
            }

            function goLogout() {
                $.mobile.changePage($('#login'), {
                        transition: 'slide'
                });

            }

        </script>
</html>


